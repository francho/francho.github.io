---
layout: post
title: Salvados por la... Sysrq
date: 2006-08-21 12:12:00.000000000 +02:00
categories:
- linux
- Píldoras
tags:
- linux
status: publish
type: post
published: true
meta:
  _edit_last: '2'
  syntaxhighlighter_encoded: '1'
author:
  login: francho

  display_name: francho
  first_name: ''
  last_name: ''
excerpt: !ruby/object:Hpricot::Doc

---
<p>Leo en <a href="http://weblog.topopardo.com/archives/000115.html">Punto y Aparte</a>:</p>
<blockquote><p>Sysrq es un genial sistema salvavidas de linux (desconozco si funciona para otros UNIX) que permite decirle al sistema "haz lo que quieras, pero no te mueras". Cuando el ordenador está frito, puede ser que siga reaccionando al teclado, pero no pueda procesar la orden por estar saturado. Por ello los diseñadores implementaron el SysRq por encima de toda prioridad, para recuperar todo lo que fuera posible. Ese "lo que quieras" es, según el orden que sigo siempre yo:</p>
<ol>
<li><strong>Alt + SysRq + R</strong>: Poner el teclado en modo <strong>R</strong>aw. Le<br />
dice al sistema que descargue todos los controladores de teclado. Si el<br />
entorno gráfico está muerto, a veces un alt+sysrq+r permite hacer<br />
ctrl+alt+F1 y abrir una terminal para matar al proceso que está<br />
jodiendo al sistema. Si esto no funciona, tenemos que pasar al</li>
<li><strong>Alt + SysRq + S</strong>: <strong>S</strong>incroniza los discos duros. Como a<br />
partir de ahora puede ser que reiniciemos el ordenador, es mejor<br />
decirle al sistema que guarde nuestros datos para que al arrancar no<br />
tenga que hacer un fsck (<em>scandisk</em>). Entonces intentamos hacer un</li>
<li><strong>Alt + SysRq + E</strong>: t<strong>E</strong>rminar todos los procesos del sistema, excepto <em>init</em>. A mi me funcionó esta vez. Cerró todos los programas, y se me abrió una consola. Si no funciona, tendremos que probar el</li>
<li><strong>Alt + SysRq + I</strong>: k<strong>I</strong>ll (matar) todos los procesos, menos <em>init</em>.<br />
En lugar de decirle a los programas que se cierren, los mata con<br />
alevosía y mala leche. El resultado suele ser el mismo que en el paso<br />
anterior, una terminal. Si tampoco hemos conseguido que reaccione,<br />
entonces tendremos que reiniciar. Haremos un</li>
<li><strong>Alt + SysRq + U</strong>: <strong>U</strong>mount (desmontar) los discos. Igual<br />
que en el segundo paso guardamos los datos de las cachés, ahora los<br />
desconectamos del sistema, para que no se casquen al reiniciar. Y<br />
ahora, un</li>
<li><strong>Alt + SysRq + B</strong>: re<strong>B</strong>oot (reiniciar). Como apretar el<br />
botón de reset, pero sin agacharse. Obviamente, perderemos todos los<br />
datos. Si hemos podido sincronizar y desmontar el disco, el sistema no<br />
se corromperá</li>
</ol>
<p>...</p>
<p>Cuando se os cuelgue el sistema, no desesperéis. Si tenéis una red local, y el servidor SSH activado (cosa que recomiendo, ni que esté sólo escuchando conexiones del otro PC), podéis entrar remotamente al PC "muerto" para matar los programas que estén cascados. Si no, se puede intentar hacer un SysRq. Aun con todo, podremos reiniciar el sistema de forma ordenada y sin corrupción de datos. Y si todo estuviera totalmente muerto, y no funcionara el teclado, apretando el<br />
botón de apagado de la torre -y con <strong>acpid</strong> o <strong>apmd</strong> instalado- el sistema entenderá lo mismo que un <strong>SysRq + S,I,B</strong>. Como veis, el ctrl-alt-supr de Windows es basura comparado con los métodos de recuperación existentes en linux.</p></blockquote>
